{"version":3,"sources":["functions/product.js","components/forms/Star.js","pages/Shop.js"],"names":["getProductsByCount","axios","create","count","a","get","process","REACT_APP_API","getProduct","slug","removeProduct","authtoken","delete","data","createProduct","product","post","updateProduct","put","getProducts","sort","order","page","getproductsCount","productStar","productId","star","getRelated","fetchProductsByFilter","arg","Star","starClicks","numberOfStar","changeRating","numberOfStars","starDimension","starSpacing","starHoverColor","starEmptyColor","SubMenu","Menu","ItemGroup","Shop","useState","products","setProducts","loading","setLoading","price","setPrice","ok","setOk","categories","setCategories","categoryId","setCategoryId","setStar","subs","setSubs","setSub","dispatch","useDispatch","text","useSelector","state","search","useEffect","loadAllProducts","getCategories","then","res","getSubs","fetchProducts","p","delayed","setTimeout","searchText","clearTimeout","console","log","handleCheck","e","type","payload","inTheState","justChecked","target","value","foundInTheState","indexOf","push","splice","category","handleStarClick","num","stars","handleSub","sub","className","defaultOpenKeys","mode","title","DollarOutlined","tipFormatter","v","range","onChange","max","DownSquareOutlined","style","marginTop","map","c","_id","name","checked","includes","StarOutlined","s","onClick","cursor","length","ProductCard"],"mappings":"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","file":"static/js/25.3f0378f3.chunk.js","sourcesContent":["import axios from 'axios';\r\nconst instance = axios.create();\r\n\r\nexport const getProductsByCount = async (count) => {\r\n  return await axios.get(\r\n        `${process.env.REACT_APP_API}/products/${count}`\r\n      )\r\n};\r\n\r\n\r\nexport const getProduct = async (slug) => {\r\n  return await axios.get(\r\n        `${process.env.REACT_APP_API}/product/${slug}`\r\n      )\r\n};\r\n\r\n\r\nexport const removeProduct = async (slug,authtoken) => {\r\n  return await axios.delete(\r\n        `${process.env.REACT_APP_API}/product/${slug}`,\r\n        { data: {authtoken} }\r\n      )\r\n};\r\n//\r\n//\r\n// export const updateCategory = async (slug,category,authtoken) => {\r\n//   return await axios.put(\r\n//         `${process.env.REACT_APP_API}/category/${slug}`,\r\n//         {authtoken, category}\r\n//       )\r\n// };\r\n\r\n\r\nexport const createProduct = async ( product,authtoken) => {\r\n  return await axios.post(\r\n        `${process.env.REACT_APP_API}/product`,\r\n        {authtoken,product}   \r\n      )\r\n};\r\n\r\nexport const updateProduct = async (slug, product,authtoken) => {\r\n  return await axios.put(\r\n        `${process.env.REACT_APP_API}/product/${slug}`, \r\n        { authtoken ,product })};\r\n\r\n\r\nexport const getProducts = async ( sort , order , page) => {\r\n  return await axios.post(\r\n        `${process.env.REACT_APP_API}/products`,\r\n        {sort , order , page}   \r\n        )};\r\n\r\nexport const getproductsCount = async () => {\r\n  return await axios.get(\r\n        `${process.env.REACT_APP_API}/products/total`\r\n          )};\r\n\r\n\r\nexport const productStar = async (productId, star,authtoken) => {\r\n  return await axios.put(\r\n        `${process.env.REACT_APP_API}/product/star/${productId}`, \r\n        { authtoken ,star }\r\n        )};\r\n\r\n\r\nexport const getRelated = async (productId) => {\r\n  return await axios.get(\r\n        `${process.env.REACT_APP_API}/products/related/${productId}`\r\n         )};\r\n\r\n\r\n         export const fetchProductsByFilter = async (arg) => {\r\n          return await axios.post(\r\n                `${process.env.REACT_APP_API}/search/filters` , arg\r\n              )\r\n        };         ","import React from 'react'\r\nimport StarRatings from 'react-star-ratings'\r\n\r\nconst Star = ({starClicks , numberOfStar}) => (<>\r\n    <StarRatings\r\n        changeRating = {() => starClicks(numberOfStar)}\r\n        numberOfStars = {numberOfStar}\r\n        starDimension = \"20px\"\r\n        starSpacing = '2px'\r\n        starHoverColor = 'red'\r\n        starEmptyColor = 'red'\r\n    />\r\n    <br />\r\n</>\r\n);\r\n\r\nexport default Star;","import React, { useEffect, useState } from 'react';\r\nimport { getProductsByCount, fetchProductsByFilter } from '../functions/product';\r\nimport {getCategories} from '../functions/category';\r\nimport {getSubs} from '../functions/sub';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport ProductCard from '../components/cards/ProductCard';\r\nimport { Menu, Slider , Checkbox } from 'antd';\r\nimport { DollarOutlined, DownSquareOutlined , StarOutlined } from '@ant-design/icons';\r\nimport Star from '../components/forms/Star';\r\n\r\n\r\nconst { SubMenu, ItemGroup } = Menu;\r\n\r\nconst Shop = () => {\r\n    const [products, setProducts] = useState([]);\r\n    const [loading, setLoading] = useState(false);\r\n    const [price, setPrice] = useState([0, 0]);\r\n    const [ok , setOk] = useState(false);\r\n    const [categories , setCategories] = useState([]);\r\n    const [categoryId , setCategoryId] = useState([]);\r\n    const [star , setStar] = useState('');\r\n    const [subs , setSubs] = useState([]);\r\n    const [sub , setSub] = useState('');\r\n\r\n    let dispatch = useDispatch();\r\n    let { search } = useSelector((state) => ({ ...state }));\r\n    const { text } = search;\r\n\r\n    useEffect(() => {\r\n        loadAllProducts();\r\n        getCategories().then(res => setCategories(res.data));\r\n        //fetch subcategory\r\n        getSubs().then(res => setSubs(res.data));\r\n    }, []);\r\n\r\n    \r\n    const fetchProducts = (arg) => {\r\n        fetchProductsByFilter(arg).then((res) => {\r\n            setProducts(res.data);\r\n        });\r\n    };\r\n\r\n\r\n    // 1.) load products by default on page load\r\n    const loadAllProducts = () => {\r\n        getProductsByCount(12).then((p) => {\r\n            setProducts(p.data);\r\n            setLoading(false);\r\n        });\r\n    };\r\n\r\n    //2. load products on user search\r\n    useEffect(() => {\r\n        const delayed = setTimeout(() => {\r\n            fetchProducts({ searchText: text });\r\n        }, 300);\r\n        return () => clearTimeout(delayed);\r\n    }, [text]);\r\n\r\n    // 3. load products based on price range\r\n    useEffect(() => {\r\n        console.log('ok to request');\r\n        fetchProducts({price});\r\n    },[ok]);\r\n\r\n    const handleSlider = (value) => {\r\n        dispatch({\r\n            type: ' SEARCH_QUERY',\r\n            payload:{ text : \"\"},\r\n        });\r\n        setStar(\"\");\r\n        setCategoryId([]);\r\n        setPrice(value);\r\n        setTimeout(() => {\r\n            setOk(!ok);\r\n        }, 300);\r\n    };\r\n\r\n    // 4. load products based on categories\r\n\r\n    const showCategories = () => categories.map((c) => <div key = {c._id}>\r\n        <Checkbox onChange = {handleCheck} className = 'pb-2 pl-4 pr-4' value ={c._id} name = 'category' checked = {categoryId.includes(c._id)}>{c.name} </Checkbox><br/>\r\n        </div>)\r\n\r\n        const handleCheck = e => {\r\n            dispatch({\r\n                type: 'SEARCH_QUERY',\r\n                payload:{text:\"\"},\r\n            });\r\n            setPrice([0,0]);\r\n            setStar(\"\");\r\n            let inTheState = [...categoryId];\r\n            let justChecked = e.target.value\r\n            let foundInTheState = inTheState.indexOf(justChecked)\r\n\r\n\r\n            if(foundInTheState === -1){\r\n                inTheState.push(justChecked);\r\n            }else {\r\n                inTheState.splice(foundInTheState , 1);\r\n            }\r\n\r\n            setCategoryId(inTheState);\r\n            // console.log(inTheState);\r\n            fetchProducts({category: inTheState});\r\n        };\r\n\r\n\r\n        // 5. products by stars rating\r\n\r\n        const handleStarClick = num => {\r\n            dispatch({\r\n                type: 'SEARCH_QUERY',\r\n                payload:{text:\"\"},\r\n            });\r\n            setPrice([0,0]); \r\n            setCategoryId([]);\r\n            setStar(num);\r\n            fetchProducts({stars: num}); \r\n        };\r\n        const showStars = () => (\r\n            <div className = 'pr-4 pl-4 pb-2'>\r\n                <Star starClicks ={handleStarClick} numberOfStar= {5} /> \r\n                <Star starClicks ={handleStarClick} numberOfStar= {4} /> \r\n                <Star starClicks ={handleStarClick} numberOfStar= {3} /> \r\n                <Star starClicks ={handleStarClick} numberOfStar= {2} /> \r\n                <Star starClicks ={handleStarClick} numberOfStar= {1} /> \r\n            </div>\r\n        );\r\n\r\n        // 6. products by Sub-category\r\n\r\n        const showSubs = () => subs.map((s) => (\r\n        <div\r\n         key = {s._id}\r\n         onClick = {() => handleSub(s)}\r\n         className = 'p-1 m-1 badge badge-secondary' \r\n         style = {{cursor:'pointer'}} >\r\n             {s.name}\r\n         </div>\r\n         ));\r\n            \r\n\r\n        const handleSub = (sub) => {\r\n            // console.log('Sub' , sub);\r\n            setSub(sub);\r\n            dispatch({\r\n                type: 'SEARCH_QUERY',\r\n                payload:{text:\"\"},\r\n            });\r\n            setPrice([0,0]); \r\n            setCategoryId([]);\r\n            setStar('');\r\n            fetchProducts({sub}); \r\n        };\r\n        \r\n        \r\n\r\n    return (\r\n        <div className='container-fluid'>\r\n            <div className='row'>\r\n                <div className='col-md-3 pt-2'>\r\n                    <h4>Search/Filter</h4>\r\n                    <hr />\r\n                    <Menu defaultOpenKeys={['1', '2' , '3' , '4']} mode='inline'>\r\n                        {/* price */}\r\n                        <SubMenu key='1' title={<span className='h6'><DollarOutlined /> Price </span>}>\r\n                            <div>\r\n                                <Slider className='ml-4 mr-4' tipFormatter={(v) => `$${v}`} range value={price} \r\n                                onChange={handleSlider} max='45000' />\r\n                            </div>\r\n                        </SubMenu>\r\n                        {/* category */}\r\n                        <SubMenu  key='2' title={<span className='h6'><DownSquareOutlined /> Categories </span>}>\r\n                            <div style={{marginTop : '-10px'}}>\r\n                            {showCategories()};\r\n                            </div>\r\n                        </SubMenu>\r\n                        {/* Star Rating */}\r\n                        <SubMenu  key='3' title={<span className='h6'>< StarOutlined /> Rating </span>}>\r\n                            <div style={{marginTop : '-10px'}}>\r\n                            {showStars()};\r\n                            </div>\r\n                        </SubMenu>\r\n                        {/* Sub Category */}\r\n                        <SubMenu  key='4' title={<span className='h6'><DownSquareOutlined /> Sub-Categories </span>}>\r\n                            <div style={{marginTop : '-10px'}}>\r\n                            {showSubs()};\r\n                            </div>\r\n                        </SubMenu>\r\n                    </Menu>\r\n                </div>\r\n\r\n                <div className='col-md-9 pt-3'>\r\n                    {loading ? (\r\n                        <h4 className='text-danger'>Loading...</h4>\r\n                    ) : (\r\n                        <h4 className='text-danger'>Products</h4>\r\n                    )}\r\n\r\n                    {products.length < 1 && <p>No products found</p>}\r\n\r\n                    <div className='row pb-5'>\r\n                        {products.map((p) => (<div key={p._id} className='col-md-4 mt-3'>\r\n                            <ProductCard product={p} />\r\n                        </div>))}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n\r\n};\r\n\r\nexport default Shop;"],"sourceRoot":""}